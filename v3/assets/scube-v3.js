"use strict";(()=>{function j(t){let e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}var F={"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"};function U(t){return typeof t!="string"?t??"":t.replace(/[&'`"<>]/g,e=>F[e]||e)}function w(t,e=[]){let a=t.tagName==="TEMPLATE"?t.innerHTML:t.outerHTML;return e.map(r=>{let n=a;n=n.replace(/\{([^}]+)\}/g,(l,i)=>{let o=i.trim();return o in r?U(String(r[o]??"")):""});let s=j(n);return s&&(s.style.display="",s.removeAttribute("id"),s.querySelectorAll('[id^="rals-tpl-"]').forEach(l=>{l.removeAttribute("id")})),{el:s,data:r}})}function W(t,e=[]){let r=(t.tagName==="TEMPLATE"?t.innerHTML:t.outerHTML).replace(/[\r\t\n]/g," ").replace(/\$\{([^}]*)\}/g,"{{= $1}}"),n=Array.from(r.matchAll(/\{\{\s*([^}\s]+)\s+([^}]+)\s*\}\}/g),s=>s);return e.map(s=>{let l=Object.keys(s),i=Object.values(s),o=r;n.forEach(p=>{let m=p[1],f=p[2];try{let c=Function.apply(null,[...l,"return "+f])(...i);m==="html"?o=o.replace(p[0],c??""):o=o.replace(p[0],U(c))}catch{o=o.replace(p[0],"")}});let u=j(o);return u&&(u.style.display=""),{el:u,data:s}})}var z=3e4;async function S(t,e=z){let a=new AbortController,r=setTimeout(()=>a.abort(),e);try{let n=await fetch(t,{cache:"no-cache",signal:a.signal});if(!n.ok)throw new Error(`API request failed with status ${n.status}`);return await n.json()}catch(n){throw n instanceof Error&&n.name==="AbortError"?new Error(`API request timeout after ${e}ms`):n}finally{clearTimeout(r)}}var G=3.30579;function L(t,e){if(t==null)return"\u898B\u5B66\u7528\u306E\u305F\u3081\u8CA9\u58F2\u3057\u3066\u304A\u308A\u307E\u305B\u3093";if(e===!0||e===1)return"\u304A\u554F\u5408\u305B\u4E0B\u3055\u3044";if(!t||t===0)return"\u4FA1\u683C\u672A\u5B9A";let a=Math.floor(t/1e4),r=t%1e4;if(r===0)return`${a}\u4E07\u5186`;{let n=r.toLocaleString("ja-JP");return`${a}\u4E07${n}\u5186`}}function R(t){if(!t)return"";let e=t/G,a=Math.round(e*10)/10,r=Math.floor(t*100)/100;return`${a}\u576A(${r}\u33A1)`}function v(t){if(t.jsonTraffic&&Array.isArray(t.jsonTraffic)&&t.jsonTraffic.length>0){let e=t.jsonTraffic.filter(a=>a.transport_min_station!==null||a.transport_min_bus!==null).sort((a,r)=>{let n=a.transport_min_station||a.transport_min_bus||999,s=r.transport_min_station||r.transport_min_bus||999;return n-s});if(e.length>0){let a=e[0];if(a.station_name&&a.transport_min_station)return`${a.station_name}(\u5F92\u6B69${a.transport_min_station}\u5206)`;if(a.bus_info&&a.transport_min_bus)return`${a.bus_info.trim()}(\u5F92\u6B69${a.transport_min_bus}\u5206)`}}if(t.trafficDataStr&&t.trafficDataStr.trim()!==""){let e=t.trafficDataStr.split(" / ");if(e.length>0){let a=e[0].trim(),r=a.match(/^(.+?)\s+徒歩(\d+)分/);if(r){let n=r[1].trim(),s=r[2];return`${n}(\u5F92\u6B69${s}\u5206)`}return a}}return""}function q(t){let e=[];return t.area1Name&&e.push(t.area1Name),t.area2Name&&e.push(t.area2Name),t.area3Name&&e.push(t.area3Name),t.area4&&e.push(t.area4),e.join("")}function D(t,e,a,r,n,s){if(!t)return null;let l=t.number,i=t.category,o,u;if(i==="layout"||i==="interior"?(o=e?"s":"r",u=a):(o="c",u=r),l===1){if(i==="exterior")return`${s}${n}/${o}-${n}-${u}-g.jpg`;if(i==="layout")return`${s}${n}/${o}-${n}-${u}-m.jpg`}let p=l-1;return`${s}${n}/${o}-${n}-${u}-${p}.jpg`}function A(t,e,a){if(!t.buildingMasterId||!t.supplierId||!t.buildingId||!t.propertyId)return null;let r=t.isSale===!0||t.hasOwnProperty("saleInfoId"),n=t.buildingName||"",s=L(t.propertyPrice,t.pricePrivateFlg),l=`${e}${t.buildingMasterId}`,i=q(t),o=v(t),u=R(t.exclusiveSize),p=t.supplierId,m=t.buildingId,f=t.propertyId,g=null,c=t.delegateImgBuilding||1,P=t.buildingImages?.find(y=>y.number===c);if(P)g=D(P,r,f,m,p,a);else{let y=t.delegateImg||1,M=t.propertyImages?.find(d=>d.number===y);if(M)g=D(M,r,f,m,p,a);else if(t.images&&t.images.length>0){let d,$;for(let I of t.images)if(!d&&I.category==="exterior"&&(d=I),!$&&I.category==="layout"&&($=I),d)break;let _=d||$||t.images[0];_&&(g=D(_,r,f,m,p,a))}}let C="";t.propertyMakeDatetime&&t.propertyMakeDatetime.date&&(C=t.propertyMakeDatetime.date.substring(0,10));let N=t.comment||"",O=t.divMasterIdStr||"",T="";return t.jsonGoingConcern&&Array.isArray(t.jsonGoingConcern)&&t.jsonGoingConcern.length>0?T="\u5C45\u629C\u304D":((t.equipmentStr||"").includes("\u30B9\u30B1\u30EB\u30C8\u30F3")||t.jsonEquipment&&Array.isArray(t.jsonEquipment)&&t.jsonEquipment.some(function(d){return d==="1453"||d===1453}))&&(T="\u30B9\u30B1\u30EB\u30C8\u30F3"),{title:n,price:s,detailUrl:l,address:i,traffic:o,area:u,thumbnailUrl:g,registDate:C,comment:N,propertyType:O,condition:T}}function b(t,e,a){return!t||!t.length?[]:t.map(r=>A(r,e,a)).filter(r=>r!==null)}var H=(t,e,a)=>{let r=t.querySelector(e);return!r&&e.startsWith("#")&&(r=document.querySelector(e)),r||a},k={apiUrl:"https://property.tenpos-ft.com/wp-json/rengodb/v1/search-properties",detailBaseUrl:"https://property.tenpos-ft.com/property/",imageBaseUrl:"https://pic.cbiz.ne.jp/pic/",fallbackImageUrl:"https://property.tenpos-ft.com/app/plugins/wp-rengodb/assets/img/noimg.png",listSelector:".list",templateSelector:".list > *",filter:t=>t,callback:()=>{},loadingMessage:"\u7269\u4EF6\u3092\u8AAD\u307F\u8FBC\u307F\u4E2D...",noPropertiesMessage:"\u7269\u4EF6\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002",errorMessage:"\u7269\u4EF6\u60C5\u5831\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u3057\u3070\u3089\u304F\u3057\u3066\u304B\u3089\u518D\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044\u3002",detailButtonText:"\u7269\u4EF6\u8A73\u7D30\u3092\u898B\u308B",customColors:{}};function Q(t){return typeof t=="string"?t:Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t[e]))}`).join("&")}function V(t,e){e&&(e.mainColor&&t.style.setProperty("--rals-main-color",e.mainColor),e.hoverColor&&t.style.setProperty("--rals-hover-color",e.hoverColor),e.cardBg&&t.style.setProperty("--rals-card-bg",e.cardBg))}var h=async(t,e={},a={})=>{let r=Object.assign({},k,a);if(!t)throw new Error("context is null");V(t,r.customColors);let n=H(t,r.templateSelector);if(!n)throw new Error("Template element not found: "+r.templateSelector);let s=H(t,r.listSelector);if(!s)throw new Error("List element not found: "+r.listSelector);n.tagName!=="TEMPLATE"&&(n.style.display="none");let l=document.createElement("p");l.style.textAlign="center",l.textContent=r.loadingMessage,s.appendChild(l);try{let i=Q(e),o=r.apiUrl.indexOf("?")===-1?"?":"&",u=`${r.apiUrl}${o}${i}`,p=await S(u);l.remove();let m=b(p,r.detailBaseUrl,r.imageBaseUrl),f=typeof r.filter=="function"?r.filter(m):m;if(f.length===0){let c=document.createElement("p");return c.textContent=r.noPropertiesMessage,s.appendChild(c),n.parentNode?.removeChild(n),{context:t,data:[],list:s,raw:p}}return w(n,f).forEach(({el:c,data:P})=>{c&&(r.callback(c,P),s.appendChild(c))}),n.parentNode?.removeChild(n),{context:t,data:f,list:s,raw:p}}catch(i){l.remove();let o=document.createElement("p");throw o.textContent=r.errorMessage,s.appendChild(o),console.error("scube error:",i),i}};async function E(t,e={}){let a=Object.assign({},k,e),r={};return t.dataset.query?new URLSearchParams(t.dataset.query).forEach((s,l)=>{r[l]=s}):(t.dataset.supplier&&(r.sup=t.dataset.supplier),t.dataset.prop&&(r.prop=t.dataset.prop),t.dataset.limit&&(r.limit=parseInt(t.dataset.limit,10)),t.dataset.order&&(r.odr=t.dataset.order)),t.dataset.api&&(a.apiUrl=t.dataset.api),t.dataset.detailUrl&&(a.detailBaseUrl=t.dataset.detailUrl),t.dataset.imageBaseUrl&&(a.imageBaseUrl=t.dataset.imageBaseUrl),t.dataset.fallbackImageUrl&&(a.fallbackImageUrl=t.dataset.fallbackImageUrl),t.dataset.loadingMessage&&(a.loadingMessage=t.dataset.loadingMessage),t.dataset.noPropertiesMessage&&(a.noPropertiesMessage=t.dataset.noPropertiesMessage),t.dataset.errorMessage&&(a.errorMessage=t.dataset.errorMessage),(t.dataset.color||t.dataset.hoverColor||t.dataset.cardBg)&&(a.customColors={mainColor:t.dataset.color,hoverColor:t.dataset.hoverColor,cardBg:t.dataset.cardBg}),h(t,r,a)}function B(t={}){document.querySelectorAll(".rals-widget").forEach(a=>{E(a,t).catch(r=>{console.error("Widget initialization error:",r)})})}if(typeof window<"u"){try{let e=globalThis.$||globalThis.jQuery;e&&typeof e.fn=="object"&&typeof e.fn.extend=="function"&&e.fn.extend({scubeV3:function(a,r={}){h(this.get(0),a,r)}})}catch{}let t="Ralsnet";t in globalThis||(globalThis[t]={}),globalThis[t].scubeV3=h,globalThis[t].scubeV3FromDataset=E,globalThis.RalsWidget3={scube:h,scubeFromDataset:E,initAllWidgets:B,fetchPropertyData:async e=>{let a=e.dataset.api||"https://property.tenpos-ft.com/wp-json/rengodb/v1/search-properties",r=e.dataset.detailUrl||"https://property.tenpos-ft.com/property/",n=e.dataset.imageBaseUrl||"https://pic.cbiz.ne.jp/pic/",s=a;if(e.dataset.query)s=`${a}?${e.dataset.query}`;else if(e.dataset.supplier){let i=[];e.dataset.supplier&&i.push(`sup=${e.dataset.supplier}`),e.dataset.prop&&i.push(`prop=${e.dataset.prop}`),e.dataset.limit&&i.push(`limit=${e.dataset.limit}`),s=`${a}?${i.join("&")}`}let l=await S(s);return b(l,r,n)},processPropertyData:A,processProperties:b}}})();
